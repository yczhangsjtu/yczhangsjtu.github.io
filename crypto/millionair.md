---
title: 姚氏百万富翁问题
layout: math
---

# 姚氏百万富翁问题

**问题**：两个百万富翁Alice和Bob的财产分别为$a,b\in[m,n]$。他们想要比较谁的财富更多，而不泄露各自的财富值。

**解决方法**：

1. Alice生成一对公私钥$pk$和$vk$，把$pk$发给Bob
2. Bob随机选取大整数$x$，用$pk$加密，得到密文$C$
3. Bob计算$c=C-b$，把$c$发给Alice
4. Alice对所有的$c+m,c+m+1,...,c+n$都进行解密，得到$n-m+1$个大整数（显然，其中第$b-m+1$个是对$c+b$即$C$的解密，也就是$x$）
5. Alice将所有这些大整数中的前$a-m+1$个（也就是从$c+m$到$c+a$）加$1$，然后把所有大整数模$p$发送给Bob
6. Bob观察Alice发来的第$b-m+1​$个大整数，将其和$x​$模$p​$比较，如果相等，说明没有被加$1​$，则$a<b​$；否则$a>=b​$
7. 将上述过程调换Alice和Bob的角色再进行一遍，双方就都知道答案了