---
title: PoW模型
layout: math
---

# PoW模型

本文尝试对比特币的PoW过程进行数学上的建模。

一个矿机挖矿的过程，可以用一个随机序列$\\{(X\_i,Y\_i)\\}_{i=1}^{\infty}$表示，其中$X\_i$为一个泊松过程，$Y\_i$为独立均匀分布随机变量。我们把$X\_i$看作时间，$Y\_i$为Hash值（除以$2^{256}$）。这个序列中的一对元素$(X\_i,Y\_i)$表示矿机在事件$X\_i$计算出了一个$Y\_i$的Hash值。

挖矿过程的时间为什么是泊松过程呢？ 

1. 首先假设矿机计算一次Hash所需的时间是均匀的，并把所有计算出的Hash值都放进序列里，则$X\_i$为离散等差数列，$Y\_i$在$[0,1]$上均匀分布
2. 现在，对$Y\_i$设阈值，如$1/N$，高于这个阈值的从序列中除去。如果单独观察$X\_i$，它们可以看做是分别独立以$1/N$的概率保留下来，于是两个保留的$X\_i$之间的距离就成了离散指数分布，$X\_i$则变为近似泊松过程
3. 矿力正比于泊松过程的参数$\lambda$，正比于对$Y\_i$设的阈值（更一般地，要求$Y\_i$满足概率为$p$的事件，则矿力乘以$p$） 

一般地，用随机过程$\\{(X\_i,Y\_i)\\}$表示一台矿机。$X\_i$为泊松分布，$Y\_i$属于$P$空间，若$Q$为$P$的子集，$P(Q)=p$，则$\\{(X\_i,Y\_i) \mid Y\_i \in Q\\}$为另一个矿机，矿力为$p \lambda$。 

一个矿机可以看作两个矿机的叠加，算力等于这两个子矿机的算力直接相加。 

接下来，我们引入一个更一般的方式，将$P$划分为不交空间的并，$P=P\_1\cup P_2\cup \cdots\cup P\_m$，对每个子空间计不同的权重。那么，上述将$Y\_i$限定在子集$Q$中的方式，实际上相当于$m=2$，$P\_1=Q$，$P\_2=P-Q$，然后给$P\_1$的权重为$1$，$P\_2$的权重为$0$。此时，把$Y\_i$限定在任意$P\_i$上，就可以得到一个子矿机。一个矿机的算力可以看作$m$个子矿机的算力的加权和。

用这个模型观察比特币的PoW，显然就是根据挖矿难度$D$简单地把$P=[0,2^{256})$划分为$P\_1=[0,D)$和$P\_2=[D,2^{256})$，并设$P\_1$的权重为$1$，$P\_2$的权重为$0$。

如果把计分设计为分段函数，则相当于更一般的情况，划分更多的子集，给不同的子集设定不同的权重。

如果矿机计算两次Hash所需的时间是指数分布而不是常数，此时$X\_i$不再是近似泊松分布，就成了真正的泊松分布。在几GHz的频率下，近似的泊松分布和真实的泊松分布之间的差别可以忽略不计。所以，为了简化数学模型，可以假设矿机挖矿过程为真实的泊松分布。

这个模型下，一个算力是$\lambda$并以$1/2^k$的概率命中目标集合的矿机，和一个算力是$\lambda/2^k$，以百分之百的概率命中的矿机是完全等价的。 
